"use strict";var _functions=require("../functions.js"),nivelUsers=document.getElementById("nivel-user"),nivelUser=nivelUsers.dataset.nivel,id=$("#id-user").val();function buscaCandi(){var n,t,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:id,nivel:nivelUser},e.next=3,regeneratorRuntime.awrap((0,_functions.token)());case 3:t=e.sent,a=JSON.stringify(n),$.ajax({url:"api/ListdataPerfil ",type:"POST",dataType:"json",data:a,headers:{Authorization:"Bearer "+t,"X-CSRF-TOKEN":(0,_functions.pushToken)(),"Content-Type":"application/json",Accept:"application/json"},success:function(e){2==e.Status?montarDados(e.data):swal(e.message)},error:function(e,n,t){console.log(e),console.error("Erro ao enviar:",t)}});case 6:case"end":return e.stop()}})}function montarDados(e){$.each(e,function(e,n){$("#nome-edit-candi").val(n.nomes),$("#email-edit-candi").val(n.email),$("#nivel").val(n.nivelUser),$("#edit-phone-candi").val(n.phone),$("#input-estado-edit").val(n.estado),$("#input-city-edit").val(n.cidade),$("#input-curso").val(n.nameCurso),$("#input-formacao").val(n.idFomacao),$("#input-genero").val(n.genero);var t=n.idUsers,a=n.cv,r="/storage/Curriculos/"+t+"/"+a,o=document.createElement("div");o.classList.add("grid-item");var i=document.getElementById("mostrar-cv"),s=document.createElement("a");s.href=r,s.download=r;var c=document.createTextNode("Clique para baixar o Arquivo: "+a),u=document.createElement("label");u.textContent="Curriculo:",s.appendChild(c),o.appendChild(u),o.appendChild(s),i.appendChild(o)})}document.addEventListener("DOMContentLoaded",function(){buscaCandi()});var form=document.getElementById("env-edit");function editCandi(){var n,t,a,r,o,i,s,c,u,d;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=$("#nome-edit-candi").val(),t=$("#email-edit-candi").val(),a=$("#edit-phone-candi").val(),r=$("#input-estado-edit").val(),o=$("#input-city-edit").val(),i=$("#input-curso").val(),s=$("#input-formacao").val(),$("#input-genero").val(),c={id:id,nome:n,email:t,phone:a,estado:r,cidade:o,nameCurso:i,nameFormacao:s},u=JSON.stringify(c),e.next=12,regeneratorRuntime.awrap((0,_functions.token)());case 12:d=e.sent,$.ajax({url:"api/EditarCandy",type:"POST",dataType:"json",data:u,headers:{Authorization:"Bearer "+d,"X-CSRF-TOKEN":(0,_functions.pushToken)(),"Content-Type":"application/json",Accept:"application/json"},success:function(e){e.Status,swal(e.menssage)},error:function(e,n,t){console.log(e),console.error("Erro ao enviar:",t)}});case 14:case"end":return e.stop()}})}form.addEventListener("submit",function(e){e.preventDefault(),editCandi()});var formCv=document.getElementById("form-env-new-cv");function EnviArquivo(){var n,t,a,r,o,i,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new FormData,t=document.getElementById("arquivo-Inpu-edit"),(0,_functions.verificarArquivo)(t)){e.next=6;break}return swal("Campo não pode ser vázio"),e.abrupt("return");case 6:return a=t.files,n=new FormData,r=a[0],n.append("arquivoCv",r,r.name),n.append("nome",$("#nome-edit-candi").val()),n.append("id",id),e.next=14,regeneratorRuntime.awrap((0,_functions.token)());case 14:return o=e.sent,e.prev=15,e.next=18,regeneratorRuntime.awrap(fetch((0,_functions.urlMaster)()+"/api/NewCv",{method:"POST",body:n,headers:{Authorization:"Bearer "+o,"X-CSRF-TOKEN":(0,_functions.pushToken)(),Accept:"application/json"}}));case 18:if((i=e.sent).ok){e.next=22;break}throw console.log(i.json),new Error("Erro na requisição: ".concat(i.Status));case 22:return e.next=24,regeneratorRuntime.awrap(i.json());case 24:(s=e.sent).Status,montarmsg(s.Message),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(15),console.error("Erro ao enviar arquivo:",e.t0);case 31:case"end":return e.stop()}},null,null,[[15,28]])}formCv.addEventListener("submit",function(e){e.preventDefault(),EnviArquivo()});